<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Vignette Author" />

<meta name="date" content="2017-06-27" />

<title>Artificial Neural Network correlation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Artificial Neural Network correlation</h1>
<h4 class="author"><em>Vignette Author</em></h4>
<h4 class="date"><em>2017-06-27</em></h4>



<div id="how-do-we-find-the-limits-of-accuracy-in-the-ann10-correlation" class="section level2">
<h2>How do we find the limits of accuracy in the <code>ANN10</code> correlation</h2>
</div>
<div id="get-z-at-selected-ppr-and-tpr" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get a z value using DPR correlation</span>
<span class="kw">library</span>(zFactor)
<span class="co"># library(rJava)</span>

<span class="kw">z.Ann10</span>(<span class="dt">pres.pr =</span> <span class="fl">1.5</span>, <span class="dt">temp.pr =</span> <span class="fl">2.0</span>)
<span class="co"># HY = 0.9580002</span></code></pre></div>
<pre><code>[1] 0.9572277</code></pre>
<p>From the Standing-Katz chart we obtain a digitized point at the same <code>Ppr</code> and <code>Tpr</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get a z value from the SK chart at the same Ppr and Tpr</span>
<span class="kw">library</span>(zFactor)

tpr_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.0</span>)
<span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr_vec, 
                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="st">&quot;1.5&quot;</span>]</code></pre></div>
<pre><code>  1.5 
0.956 </code></pre>
<p>It looks pretty good.</p>
</div>
<div id="get-z-at-selected-ppr-and-tpr-1" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
<span class="kw">z.Ann10</span>(<span class="dt">pres.pr =</span> <span class="fl">1.5</span>, <span class="dt">temp.pr =</span> <span class="fl">1.1</span>)</code></pre></div>
<pre><code>[1] 0.4309125</code></pre>
<p>From the <code>Standing-Katz</code> chart we obtain a digitized point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
tpr_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.1</span>)
<span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr_vec, 
                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="st">&quot;1.5&quot;</span>]</code></pre></div>
<pre><code>  1.5 
0.426 </code></pre>
<blockquote>
<p>At lower <code>Tpr</code> there is some error. We see a difference between the values of z from the ANN10 calculation and the value read from the Standing-Katz chart.</p>
</blockquote>
</div>
<div id="get-values-of-z-for-several-ppr-and-tpr" class="section level2">
<h2>Get values of <code>z</code> for several <code>Ppr</code> and <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test HY with 1st-derivative using the values from paper </span>
 
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 
tpr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="dv">2</span>) 
 
dpr &lt;-<span class="st"> </span><span class="kw">z.Ann10</span>(ppr, tpr)
<span class="kw">print</span>(dpr)

<span class="co"># From Hall-Yarborough</span>
<span class="co">#    0.5       1.5       2.5       3.5       4.5       5.5       6.5</span>
<span class="co"># 1.3 0.9176300 0.7534433 0.6399020 0.6323003 0.6881127 0.7651710 0.8493794</span>
<span class="co"># 1.5 0.9496855 0.8581232 0.7924067 0.7687902 0.7868071 0.8316848 0.8906351</span>
<span class="co"># 1.7 0.9682547 0.9134862 0.8756412 0.8605668 0.8694525 0.8978885 0.9396353</span>
<span class="co"># 2   0.9838234 0.9580002 0.9426939 0.9396286 0.9490995 0.9697839 0.9994317</span>

<span class="co"># From Dranchuk-AbouKassem</span>
<span class="co">#  0.5       1.5       2.5       3.5       4.5       5.5       6.5</span>
<span class="co"># 1.3 0.9203019 0.7543694 0.6377871 0.6339357 0.6898314 0.7663247 0.8499523</span>
<span class="co"># 1.5 0.9509373 0.8593144 0.7929993 0.7710525 0.7896224 0.8331893 0.8904317</span>
<span class="co"># 1.7 0.9681353 0.9128087 0.8753784 0.8619509 0.8721085 0.9003962 0.9409634</span>
<span class="co"># 2   0.9824731 0.9551087 0.9400752 0.9385273 0.9497137 0.9715388 1.0015560</span></code></pre></div>
<pre><code>          0.5       1.5       2.5       3.5       4.5       5.5       6.5
1.3 0.9196115 0.7567070 0.6394479 0.6341957 0.6857549 0.7611212 0.8471371
1.5 0.9508509 0.8607096 0.7940885 0.7685691 0.7867923 0.8323518 0.8918874
1.7 0.9682749 0.9146453 0.8767457 0.8581919 0.8672123 0.8978116 0.9413442
2   0.9839990 0.9572277 0.9414698 0.9352303 0.9453140 0.9693022 1.0014522</code></pre>
<p>With the same <code>ppr</code> and <code>tpr</code> vectors, we do the same for the Standing-Katz chart:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

sk &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr, <span class="dt">tpr_vector =</span> tpr)
<span class="kw">print</span>(sk)</code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.30 0.916 0.756 0.638 0.633 0.684 0.759 0.844
1.50 0.948 0.859 0.794 0.770 0.790 0.836 0.892
1.70 0.968 0.914 0.876 0.857 0.864 0.897 0.942
2.00 0.982 0.956 0.941 0.937 0.945 0.969 1.003</code></pre>
<p>Subtract the two matrices and find the difference:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">err &lt;-<span class="st"> </span><span class="kw">round</span>((sk -<span class="st"> </span>dpr) /<span class="st"> </span>sk *<span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)
err

<span class="co"># DAK</span>
<span class="co"># 0.5   1.5  2.5   3.5   4.5   5.5   6.5</span>
<span class="co"># 1.30 -0.47  0.22 0.03 -0.15 -0.85 -0.97 -0.71</span>
<span class="co"># 1.50 -0.31 -0.04 0.13 -0.14  0.05  0.34  0.18</span>
<span class="co"># 1.70 -0.01  0.13 0.07 -0.58 -0.94 -0.38  0.11</span>
<span class="co"># 2.00 -0.05  0.09 0.10 -0.16 -0.50 -0.26  0.14</span></code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.30 -0.39 -0.09 -0.23 -0.19 -0.26 -0.28 -0.37
1.50 -0.30 -0.20 -0.01  0.19  0.41  0.44  0.01
1.70 -0.03 -0.07 -0.09 -0.14 -0.37 -0.09  0.07
2.00 -0.20 -0.13 -0.05  0.19 -0.03 -0.03  0.15</code></pre>
</div>
<div id="error-by-ppr-and-by-ppr" class="section level2">
<h2>Error by <code>Ppr</code> and by <code>PPr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">colSums</span>(err))</code></pre></div>
<pre><code>  0.5   1.5   2.5   3.5   4.5   5.5   6.5 
-0.92 -0.49 -0.38  0.05 -0.25  0.04 -0.14 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">rowSums</span>(err))</code></pre></div>
<pre><code> 1.30  1.50  1.70  2.00 
-1.81  0.54 -0.72 -0.10 </code></pre>
</div>
<div id="analyze-the-error-for-smaller-values-of-tpr" class="section level2">
<h2>Analyze the error for smaller values of <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>) 
ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>) 

sk2 &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr2, <span class="dt">tpr_vector =</span> tpr2, <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)
sk2</code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5
1.05 0.829 0.253 0.343 0.471 0.598 0.727
1.10 0.854 0.426 0.393 0.500 0.615 0.729</code></pre>
<p>We do the same with the DPR correlation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate z values at lower values of Tpr</span>
<span class="kw">library</span>(zFactor)

dpr2 &lt;-<span class="st"> </span><span class="kw">z.Ann10</span>(ppr2, tpr2)
<span class="kw">print</span>(dpr2)</code></pre></div>
<pre><code>           0.5       1.5       2.5       3.5       4.5       5.5
1.05 0.8324799 0.2526076 0.3420322 0.4693520 0.5991874 0.7254470
1.1  0.8547310 0.4309125 0.3930420 0.4983162 0.6136523 0.7278621</code></pre>
<p>Subtract the matrices and calculate the error in percentage:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">err2 &lt;-<span class="st"> </span><span class="kw">round</span>((sk2 -<span class="st"> </span>dpr2) /<span class="st"> </span>sk2 *<span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)
err2

<span class="co"># DAK</span>
<span class="co"># 0.5    1.5    2.5   3.5   4.5   5.5</span>
<span class="co"># 1.05 -0.13 -12.15 -12.78 -7.49 -4.34 -1.68</span>
<span class="co"># 1.10 -0.36  -4.79  -4.97 -3.56 -2.14 -1.21</span></code></pre></div>
<pre><code>       0.5   1.5   2.5  3.5   4.5  5.5
1.05 -0.42  0.16  0.28 0.35 -0.20 0.21
1.10 -0.09 -1.15 -0.01 0.34  0.22 0.16</code></pre>
<p>Transposing the matrix with <code>Tpr</code> as columns and <code>Ppr</code> as rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t_err2 &lt;-<span class="st"> </span><span class="kw">t</span>(err2)
t_err2</code></pre></div>
<pre><code>     1.05  1.10
0.5 -0.42 -0.09
1.5  0.16 -1.15
2.5  0.28 -0.01
3.5  0.35  0.34
4.5 -0.20  0.22
5.5  0.21  0.16</code></pre>
<p>A statistical summary by <code>Tpr</code> curve:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum_t_err2 &lt;-<span class="st"> </span><span class="kw">summary</span>(t_err2)
sum_t_err2</code></pre></div>
<pre><code>      1.05               1.10         
 Min.   :-0.42000   Min.   :-1.15000  
 1st Qu.:-0.11000   1st Qu.:-0.07000  
 Median : 0.18500   Median : 0.07500  
 Mean   : 0.06333   Mean   :-0.08833  
 3rd Qu.: 0.26250   3rd Qu.: 0.20500  
 Max.   : 0.35000   Max.   : 0.34000  </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We can see that the errors in `z` with `ANN10` are less than `HY` with a `r sum_t_err2[1,1]`% and `r sum_t_err2[6,1]`% for `Tpr = 1.05`, and a `r sum_t_err2[1,2]`% and `r sum_t_err2[6,2]`% for `Tpr = 1.10`. </span></code></pre></div>
</div>
<div id="prepare-to-plot-sk-chart-vs-ann10-model." class="section level2">
<h2>Prepare to plot <code>SK</code> chart vs <code>ANN10</code> model.</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)
<span class="kw">library</span>(tibble)

tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>) 
ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">3.5</span>, <span class="fl">4.0</span>, <span class="fl">4.5</span>, <span class="fl">5.0</span>, <span class="fl">5.5</span>, <span class="fl">6.0</span>, <span class="fl">6.5</span>) 

sk_dpr_2 &lt;-<span class="st"> </span><span class="kw">createTidyFromMatrix</span>(ppr2, tpr2, <span class="dt">correlation =</span> <span class="st">&quot;N10&quot;</span>)
<span class="kw">as.tibble</span>(sk_dpr_2)</code></pre></div>
<pre><code># A tibble: 52 x 5
     Tpr   Ppr z.chart    z.calc           dif
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
 1  1.05   0.5   0.829 0.8324799 -0.0034799212
 2   1.1   0.5   0.854 0.8547310 -0.0007310197
 3   1.2   0.5   0.893 0.8953923 -0.0023923156
 4   1.3   0.5   0.916 0.9196115 -0.0036115485
 5  1.05   1.0   0.589 0.5896265 -0.0006265401
 6   1.1   1.0   0.669 0.6708697 -0.0018696755
 7   1.2   1.0   0.779 0.7807145 -0.0017144762
 8   1.3   1.0   0.835 0.8363278 -0.0013277938
 9  1.05   1.5   0.253 0.2526076  0.0003924371
10   1.1   1.5   0.426 0.4309125 -0.0049124610
# ... with 42 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)

p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_dpr_2, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>() +
<span class="st">    </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span>.<span class="dv">4</span>,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="analysis-at-the-lowest-tpr" class="section level2">
<h2>Analysis at the lowest <code>Tpr</code></h2>
<p>Extract only values at <code>Tpr = 1.05</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk_dpr_3 &lt;-<span class="st"> </span>sk_dpr_2[sk_dpr_2$Tpr==<span class="fl">1.05</span>,]
sk_dpr_3</code></pre></div>
<pre><code>    Tpr Ppr z.chart    z.calc           dif
1  1.05 0.5   0.829 0.8324799 -0.0034799212
5  1.05 1.0   0.589 0.5896265 -0.0006265401
9  1.05 1.5   0.253 0.2526076  0.0003924371
13 1.05 2.0   0.280 0.2813986 -0.0013986023
17 1.05 2.5   0.343 0.3420322  0.0009678343
21 1.05 3.0   0.407 0.4046718  0.0023282390
25 1.05 3.5   0.471 0.4693520  0.0016480466
29 1.05 4.0   0.534 0.5347267 -0.0007266737
33 1.05 4.5   0.598 0.5991874 -0.0011874468
37 1.05 5.0   0.663 0.6627276  0.0002723595
41 1.05 5.5   0.727 0.7254470  0.0015529844
45 1.05 6.0   0.786 0.7868394 -0.0008393750
49 1.05 6.5   0.846 0.8464481 -0.0004481081</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_dpr_3, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>() +
<span class="st">    </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span>.<span class="dv">4</span>,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sk_dpr_3)

 <span class="co">#         dif ANN10      </span>
 <span class="co"># Min.   :-0.048404  </span>
 <span class="co"># 1st Qu.:-0.035300  </span>
 <span class="co"># Median :-0.025978  </span>
 <span class="co"># Mean   :-0.023178  </span>
 <span class="co"># 3rd Qu.:-0.009960  </span>
 <span class="co"># Max.   : 0.002325</span></code></pre></div>
<pre><code>     Tpr                 Ppr         z.chart           z.calc      
 Length:13          Min.   :0.5   Min.   :0.2530   Min.   :0.2526  
 Class :character   1st Qu.:2.0   1st Qu.:0.4070   1st Qu.:0.4047  
 Mode  :character   Median :3.5   Median :0.5890   Median :0.5896  
                    Mean   :3.5   Mean   :0.5635   Mean   :0.5637  
                    3rd Qu.:5.0   3rd Qu.:0.7270   3rd Qu.:0.7254  
                    Max.   :6.5   Max.   :0.8460   Max.   :0.8464  
      dif            
 Min.   :-0.0034799  
 1st Qu.:-0.0008394  
 Median :-0.0004481  
 Mean   :-0.0001188  
 3rd Qu.: 0.0009678  
 Max.   : 0.0023282  </code></pre>
</div>
<div id="analyzing-performance-of-the-ann10-correlation-for-all-the-tpr-curves" class="section level2">
<h2>Analyzing performance of the <code>ANN10</code> correlation for all the <code>Tpr</code> curves</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(tibble)

<span class="co"># get all `lp` Tpr curves</span>
tpr_all &lt;-<span class="st"> </span><span class="kw">getCurvesDigitized</span>(<span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="fl">2.0</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">3.5</span>, <span class="fl">4.0</span>, <span class="fl">4.5</span>, <span class="fl">5.0</span>, <span class="fl">5.5</span>, <span class="fl">6.0</span>, <span class="fl">6.5</span>) 
sk_corr_all &lt;-<span class="st"> </span><span class="kw">createTidyFromMatrix</span>(ppr, tpr_all, <span class="dt">correlation =</span> <span class="st">&quot;N10&quot;</span>)
<span class="kw">as.tibble</span>(sk_corr_all)

p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_corr_all, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>() +
<span class="st">    </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span>.<span class="dv">4</span>,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABAlBMVEUAAAAAADoAAGYAOpAAZrYAqf8AuOcAvmcAv8QAwZoMtwIzMzM6AAA6ADo6AGY6OmY6OpA6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOpBmtv9uTU1uTW5uTY5ubo5ubqtuq+R8rgCElP+OTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQZgCQkDqQkGaQtpCQ29uQ2/+rbk2rbm6rjk2rowCryKur5OSr5P+2ZgC2///HfP/Ijk3I///NlgDbkDrb///kq27k///mhhPr6+vtaO3y8vL4dm3/Ycz/aKH/tmb/yI7/25D/5Kv//7b//8j//9v//+T///8UIMrPAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAVj0lEQVR4nO2dDYPbtpGGt6ml1e4laRo3PfcjaZtIaa9xrnfXpNVd7XW1cQVZ8np3veH//ytHfM8MBiRIghJX4jiWGQqiiEfvDEAMAZ4VR25vWEv//Fl/pzYMGwHV2AioxqoA3X78Uv/74dnZ55HPnw6g1WpFAN2cfaAA3f/qu+L2o+/4z58MoNUKEpLvvPjJ/2gF3TyR/xeR0PEDWgUWuFihVcRaC0AiNG5fbG9PhaOAogqCgB6efxr5/MkAYmKQB3T/LMbnhABVtmKxNmwEVMfnBIJ0DaDy7/WZtHyt2N5E0ahwG0ApNgIaAY2A9K4RELv37du3I6CKvW/fWkIjIGBONgmAutpjBPSWWCWg01FQKJtdaeXWbgTkqAAr4ZR7N+U/m1MGxEUbsXu7U7LZGDthQEy02RkzYCyfUwJEVANlY/1qY/xKXEk7MUBQMBCQpQP96oQAscFG7HQ03vF+dWWsNSA7YHZzZvIbwwXEdm1MvNHb1K8MGMunHtByuSSAbNpHcrp+MkRAkTbKqabWr4RYLBZpgJZLSEi+49I+FtJAANEYzMrGlNhot4r6leRjCEUBLQMLXKy0AyvIQ3FaIVRIsLGAiGyoX6UAiioIALr98CeRtFifgEIHInKJyMZsbWr9amEsCRATgw6cOGSowN1R2SAucb/ykEQaoIpWTFrG1HOVVpgII5iWW/geMZaNQG5V61fwN2oP6OanP7RV0N3v/6n+ff/101/+CwNiwoqIxl0CxYBhZIPdCvmVNehXGQCpNv7srF0Mevf0MwXox++/KV7/OwLEhRVARY1E7KgJwUYbIhviVjjwmBfHZzKZtAeUYlWAXv3if7WC3v/pn05MEJALKztLRW0G+oBQKJVANogL8SsXcAAfQ+gQgJyL3X35r+L9H/9Rbv1baeodRccqw2yWu9Wm/qzqwwSbhUJh/9WbZrfZUnTCU1F4gr0KUGUV9gLo3S8tIGlaB2+vrnamjvYySW1vdpskE2wvh7gV26B7BU0mg1OQA7TZLRYbUxk/rAfrzG9y0UbgaIz5hA26DTzm5YAxyAFiYtBiU/6xFSoraiqoNoPqw01KhZGNN7a9gsKZSjs8oB+//4q2YovFdGJ/3qurhaaD6grqTPSBCrOygeqJANKb9YC6Wj0g+TfsB00W04U5zUWJ58qp6Yqyihjh5hsmxIXhAwPP9NAKYk2f2mQ2KU9NnekCWCkmwiqiIF42grqV77eHgUeisXwGB2g2Lf+oUyzPtqzRJPj5ga4giQoqwEJARDgaT3kes9kwAV3M5J+ZOlcQExwdVFdU51ArhApyK6ZLCB1rNrOEBgdImjxB6W3TqTv9ePVh7K1GCMwcdQL1AyLzgAGdX8g/GpHkMw2qUc2KUonycUfEgXn4gKSVQpInCU4ZAvJbsPoxKuyYGzyc/gbzYh1suDHo8rz8I6SryfOcTmfCRmxkTKV5rQTNlSDHQMIpDB74+RaA4J32GWf7aEDSpIZKRDMr9KkKRtPw10eoagawERckIItHycbgUZEwCdB8PieAbnw27DrndCgPqPQ0dZLlCV8Ii2g6xRWlYuJ1hWCCEgXAEwYe21YkAJrPISH5Dkj73P7sN7kBzUs+c6EJ2bPUrT6MR4woeGHFaDKBpymgeWCBiz18+9fsLqa+6VIT8mcpo9HUKQmLiWBgdocSQ0eBeHIoyAO6/jR/DFLfJzwhceHPHlQurDMDS1C/ckYDj4nMMxeAOsUgN1fjkx/yA5KEyldFyLT4F+7nhb/+1HsKhRWXDfw8DDyuTTd4gNUCirdieq5GZEJUa0DL5ZIQMk3+zDbApKKk/jwVWp4NPFqxGo/+5m6Aij6aeZXJNYQsINlvNJLXmGyFiJggC1iCoWlbsUjgAV/dFpCG1BMgoQn5s0TxOgxHU2D8bkKQCzwZAaVYd0CakDin5w59AntYDRXMBxwF8hk8IEmofNWEQJ+RADK1g5UM/YpQAcbiAd3n824xqFdAkpEhZHvV5wLFTw8H19MfgAk24edgZLaHthfMANzgAK1WKwLIiMj+zKDOCFCgCQIIcSGB5wIURngGBUiZmoa+LDfmRaEAqb3nRSl5tXVxUf53YQrPvOltv78INmEBYIqP2ZZfor+msN8ctUMpSAMSWkNWQYJv0KAQoOMAYc2IBcLiI7MX7+Bm+yhALgoVuscYBQQM0WGpIB+0A7wgMjcDdMgYJFyclvsuOUAMIqKmYBMZjMzOHgegEpEBVBJS+ywhG6s1HfMC6hi0V2QT8wkYn4O2/VI45x4gIEBoPneETB0ACSqlBvcMh3z0oQvLB3x+wID00Ac6YVUPV7IZIFP24gKTVdo8B4UvL9HnBwpIEnKA4E8KHEGgqrKhm9IMC4PAA2KeFe8wAVkJeUCgwUc1iogCmN8ZkRs8nPwSx8d89WABWUIeUNglIiQgC7gXWCUg8CXdALkh17P4dJ/WgNbrtSdUiGaAMApChWvyYNPVElD5GQLIpX1iN5F3AbSWBgAZQpfYx+gFEy8bEe1VGkDkKP5LgHPXAVIfQoBc2ufh29hN0nkAlYTkPk+oqnIi0rhF+HCQfednbkddqgBdBkZd7P5ZfPmgjoCshArhCAnflnHuIZgGnezFfAI8l67w3I7bVQKKKshnNT76Lq6ibjHISsgPnkFCbAvUqKMYALLXFYZPA0BMDOp3Mst2uxWGkD3LOalHV0Dn53zbLrxLL5erVEAVrVgfgLZbTQgCAoSEd4SgpnWAdEn4avi46OZjc4lnueoKSM72efjPzM08C4gQqqszDyhCk23bl3rUpQugTrN9EgBZQva3BYQu8cUSU3v8BiwScuMALbeOz/B60iWftQVUVmPpzz2sUYCIpwIsAAQGNhygko8/7uAAlYgUIEUIAQo71QEgjIJQYfoE6ECOjwB8Bg/IEKoHxMhGsB0eDwgfxgzxSj7rgQMSzsc4QKhdpnX2gAJsyMJjzIX9vi3kcxBAfobG3RdmciYDSBLSv6glBEkwIqKNG92L+VwyfFSrCQPQYQD5mapyrthrN5ulEpCrhGDjRxRFIiDHBwegCkBdrQKQnyWmJtT9Cc0XU4SMxle6do4QBoRboEaALvneoQKEAlAFoB4V5OcZegW5OavStsVa/bvS/7t0b8zJkXzqtYGpj/jPKT7mi6StEw/TIyAwU5WZNy+gj5lbYrAnsJ28BAWpspf0gheEf399MRQF3f3uH8W7z0IXE9bHKCDX1gBAeJgoDihSmL2+OCwgH4OYWc8Y0MqOnCFCdaKoABTsnrv8RRmet+tBAPIzVaMKMj0h+4sCQDYhjcxw4jpHLhd4yQLy13hLORS1oiH6kP0gKaJ3T5/+wgoIVHtLABEJ1TZMlJ0wL7TJmyM+KzOaeXhAEUsDhLqMlBCi4rkx4Pxot/uCFcen04DZw/P8wx0QkPAxE0qIJ0RH0MEuBqc8BOVTdr8YbdYCKrvtBBBM+8hBsz4AGUJFOqBQNo4Ry8cdw4zKreRXtgCkLvwQIJf2uf91bI3A/IDg2FkEEN9eRQVkj2GGLRWfRoDo+IrCpN9zczX+0pOLOR8r7JWRH32NBiHa+gd7qwBpPnkUhB48cvtJHy5WDcjnW2OAavbOfefHXoC572sMiIlBYLZPX4u8WR+LAuIIJQKa4944FFArQPFW7P63ewAECOE6h26WBmiOdy9VZ8J23fMCkq1Yby5GAQnQkgW94DRAqmknQyaaj+s/ZwQk/94/622x260Pmr4ho3UmhGoA4dZPjzQtTW90mxdQinUG5JrdUEKozh0AqeOhS/hDAZIPsnt4Hlv2NRmQJVQliiigeVBYH20NPOxggF48UZRqCEUAhRJqAUgWg2Vdo4ivUA8E6P6ZusPhJhqwUgEZQhgQSnYENtdoyF7Xayjbr+2jBGQI1QDC1ecAEceigFYyQ7Be2xh9MBe7lmgqnhhZDSggxPT9iAdhQOFu0O9cm5slmgLqargVu6mYQN4IkCJUKxWzNZ/HBCScgLx6GgI6cDPfGBCkAcHwfFz7iPk8MkDCDWARQpUX6FQ2QeGldVN51AEAUvfCamsYpHlA9t5XjhBhxdbZtO66d0j4DFxB2LZF4ZKcK/jGMixLzeVKQ9OfVt3n8gu2rU/v4C6mg5DdhyUELuxrfn60FzRd+vqC6udwCrr9sLGLaR/jAKGhoQaA4OcGBqi8FHt4/rnpLrYChLpCmQAxfDKPByU/yliiefFpPAOyd0DqziOGTytAFxcXBBBY5C0t7SMBXT9pdqmhg5C7SqI+1hzQUkA+8sh5AKmZMwgQfLZPdMQ1uJov6Vw3UpAcM1vzhAohOEKVgMAHVkKwSeaGgOgENYVJv+enIkQf7ROOB72Ip4haAOIIVQBaYj5ZAEUVBADFBZThySwEELgxRde5ASBYVh0mIyAmBnlAFWE3ByCB+FQOjEZ3y8AT8MFjHB0BxVuxQjZNSYCaD7kaQkUFoEBCHCDa5JljuBkh/QKqmpPZccg1AVBAqA6QP8Ra8Hyyp33iIajziCIBFMagkFANIM9YtvBpWcaWgFIsNyDYjqG+X1XtlqDz4wGpHtCgALUZcg0BiTBI4wgTDGzg8VkLSPcQhwWoxZCrJtQSkGq6aI4ICWhogJKMAyQ4H8OAHCKeGx0QMJcYxwjI1RFLBb/GABE+gwTUNEgnAIKkiOE6ez65AHW1PhRkqxnrMkMJ4ToHfAapoP0BonU23R84xnEUgMS2AaDYUHUB+QwU0P0zdZHROAZJQByhJher4PpiXZOFPyQgNQbpAPlZYj9+z87VyAdoRQBVFj4coF999+LscwcIPF311TdqSlQyILvcQBtAAg0BDQuQHJM+e2IHAfx8MT9fdQ+A8BDH4ADJ3JhREJhx+OXfjYuhOavOyhoVZA7pKixVZTqDKm2tADX7dJVVAbJS8HUOLbyaf3huCvt5hndffKNwaQsFpH7zUELpClq5veveFDSbzQggm/aRw0HRTEXanNXwOatZAYHCa4EHybIBUsvpIkAu7aOmIsRm/CTNWX3/58aAgCjqarcCAct3obMBCpdlpi7WVkHg6aqvKl1M/+ZtAcFeZcCnTwX5GFT2b6JpjbQ5q+VWuHYHJCQCQG42fU3t4JXtWvQHiIlBcBW8aO84y6VGW0B0hD8UUL/NPFjDrKfZPu7sGEL1gGgKhOGzF0B7UBAHyK7HkAyI49M/IPn3podF3lIAhcsjxAHp64s9A0qxHl2MW2ED1o7wSb7R5VQAoffwGMcIiPI5DUAcoWjt6DsRPkcNyI+ihrUL+ETuUjgaQGxXkSPBu946dp/LcaR9qgAJCoPlE70R6PgVJKiIThkQJeQ6PAQPBaS6iKcQg2KAbHsGXymfRjmiowTkuZADmEuMEVCsdiOgakD2GvXYAXHNGBoZi9TOXcMfAlDTtE9nQIRQbZ1NDnU/gKbTKQHk0j4yYZpxkTfeVK4vdQVabeoK1XyyNwN8ACH5Dk779Dzk2kpB5jaFqlvJMihoGhh1sYEDqryVLJ+LhQoCDz8qXSw25nrwGFR9p1SvMQgG6Z9nf/gRCwgTqlWQfNkboIpWrKhYbPKAgBCfQwJSqefYDJ5sgBgfq64zuU3hUIBM2qdV6rlvQGiM4+h70k0BrcUIqKrOZgzo5AAhQhV11sUOHYOGDqhuUakTBhTyGQHB3cbB9gKoq+UDFEZpvnL2PvGkW8mOSUGJgOxMg7RbyY4QUN08ixMHVLfiKhkEGgHxgMQIKFq5NWzyThBQXQwySwcn32t3fIAEaMjCknZ999MEFBAKStpnPqTfa9cnILkoYs2CfzWA4IP75PTDroDCK9R9AppMJgiQHEeUt5C3BwSmZBbF66fpgCJPv3B8UtdMygpoMoGEyjdu5CBr7CnzSYD8dKiiuPvDfzQAxD4/xVDbO6BJYD4GVa2sVA8ITKP78W//p12Mn5JpzKdIaYZVp1B1obwzLmstqqBCL0lWZ2mPEX39VZMYJHxzZf4P9I6a3WvXYwxKWCmpBhCaktkQEH4KGAKUXue8gJhWrL4NS4xBr59K+6oJIPQcOQCoyapb/QJK45M4JTOtmacSKiweAfkMBVDlGsBJgMCUzBaA7DLcaCXNZotK9Qso0XL2pEkPea2kg3aNgDAfug5rw0WlTg5Q00WlTg1Q4zWTjhyQiAhoz4C6Wo+ASDWaLyqVBdCgFFSVC2yxoMsJAWq3oMvpAGq5JNAIaAQ0AkoDNMagOgW1q/PJAGq7ZlLPgHzapyoBlBcQf1fdMAAtFgsEyKd9KhNAewDUelGprIAWC0iogGmfygRQ/4DaLyqVB9AisDdM2qf/6VAxQB3WTMoDKKagAqZ94gmgkwEUxCCY9qlIAPUNqMuiUnkBMa2YDTtVCY5sc1a10ZzpPnOovEUBpfHpW0GdFpXqV0Em7XP78cvkh0BmAISI8DcCDQVQovUIqPOCLkcOqPuSQCOgEdAIKA5oO5AY1NX6ApRjxZssgIapoG2WBV2OEpAilGk5jqMEJANPrtUmjhFQ1pneI6AR0AgoOOGcawUcJaCcdW5UuDkgmOx5eL6ntE/WOjcqXAvo6uoKAULJnut95cWy1rlR4TpAV1eQUIGTPbc/+83pAroK7A1N+zx8+9fRxQIFFT7Zc/3pGIPCGOSTPbef/DACYlsxA0UP2kcyY5nTPsjiU+/2WDgKCCV7sioo2YYNyKd9ihEQ62JpNgKqsT4BDcJGQDU2AqqxEVDPdvSABquguy+e+uU+6g1MGq4vap7MnWRDBSRXJLj7XXo9XqfTfPWNWhQi0YYK6J2ccP8qudJw8ZQak+sdNLChApLmn59dZ27xlAS7+/Lvx+BihV65IdHQ4ik1dvcFfDJ3rQ0X0Puvk/ngxVPqCzfQ5nAByR861fDiKTX2/s9HAagJH2kNmvlXmVzMp30enmd91nOSaVGkQ2oA6P3XTz9Lb8gck81mgwCBtM+Lz9Uj1Vk7mZ70ZgMJFTDtE33oiLTjB7QJ7A1J+9x+8pf9u9hgLKqgwqV95Oi0fEIUaycDKIhBKO2Tdb7Y47KqVswM1N//dgTEAAJpnxejizGAQNrn/lnWh0A+Lou7WJrtH1DZbZUWbVcz22MEpNqO66io89qjBSSfvLgPe8yAbj/6b/VouNuP/yseJLvaowX04oOXtx9+8PLh+ZOywY09YHAAdrAgXUpG9UTKC+rEZWfb2aNVUFHowQblaj22aCOgGnvUgJSLffxyBIQMAjJBegQEDbpY2cw/KUZAMesVjLURUI2NgGosDggt8jYOd7zZ7XYIEF7k7frk0z67HSRUwLSPGpPO+Lz5x2WaDLI3JO0zKohVUOF7HPfPsj5v/nFZNAaBtE8ZiW5iUfp0ADGtmBlEkHn5Me0TAAKLvFUp6P8Bige0UtW2a9YAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
<pre><code># A tibble: 208 x 5
     Tpr   Ppr z.chart    z.calc           dif
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
 1  1.05   0.5   0.829 0.8324799 -0.0034799212
 2   1.1   0.5   0.854 0.8547310 -0.0007310197
 3   1.2   0.5   0.893 0.8953923 -0.0023923156
 4   1.3   0.5   0.916 0.9196115 -0.0036115485
 5   1.4   0.5   0.936 0.9367118 -0.0007118312
 6   1.5   0.5   0.948 0.9508509 -0.0028509478
 7   1.6   0.5   0.959 0.9607316 -0.0017315940
 8   1.7   0.5   0.968 0.9682749 -0.0002748589
 9   1.8   0.5   0.974 0.9758251 -0.0018251256
10   1.9   0.5   0.978 0.9814269 -0.0034269385
# ... with 198 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># MSE: Mean Squared Error</span>
<span class="co"># RMSE: Root Mean Sqyared Error</span>
<span class="co"># RSS: residual sum of square</span>
<span class="co"># ARE:  Average Relative Error, %</span>
<span class="co"># AARE: Average Absolute Relative Error, %</span>
<span class="kw">library</span>(dplyr)
grouped &lt;-<span class="st"> </span><span class="kw">group_by</span>(sk_corr_all, Tpr, Ppr)
smry_tpr_ppr &lt;-<span class="st"> </span><span class="kw">summarise</span>(grouped, 
          <span class="co">#mean=mean(z.calc), </span>
          <span class="co">#sd=sd(z.calc), </span>
          <span class="dt">RMSE=</span> <span class="kw">sqrt</span>(<span class="kw">mean</span>((z.chart-z.calc)^<span class="dv">2</span>)), 
          <span class="dt">MSE =</span> <span class="kw">sum</span>((z.calc -<span class="st"> </span>z.chart)^<span class="dv">2</span>) /<span class="st"> </span><span class="kw">n</span>(), 
          <span class="co"># rmse2 = sqrt(sum((z.chart-z.calc)^2)/n()),</span>
          <span class="dt">RSS =</span> <span class="kw">sum</span>((z.calc -<span class="st"> </span>z.chart)^<span class="dv">2</span>),
          <span class="dt">ARE =</span> <span class="kw">sum</span>((z.calc -<span class="st"> </span>z.chart) /<span class="st"> </span>z.chart) *<span class="st"> </span><span class="dv">100</span> /<span class="st"> </span><span class="kw">n</span>(),
          <span class="dt">AARE =</span> <span class="kw">sum</span>( <span class="kw">abs</span>((z.calc -<span class="st"> </span>z.chart) /<span class="st"> </span>z.chart)) *<span class="st"> </span><span class="dv">100</span> /<span class="st"> </span><span class="kw">n</span>()
          )

<span class="kw">ggplot</span>(smry_tpr_ppr, <span class="kw">aes</span>(Ppr, Tpr)) +
<span class="st">           </span><span class="kw">geom_tile</span>(<span class="dt">data=</span>smry_tpr_ppr, <span class="kw">aes</span>(<span class="dt">fill=</span>AARE), <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>, <span class="dt">mid=</span><span class="st">&quot;yellow&quot;</span>, <span class="dt">na.value =</span> <span class="st">&quot;pink&quot;</span>,
  <span class="dt">midpoint=</span><span class="fl">12.5</span>, <span class="dt">limit=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="dt">name=</span><span class="st">&quot;AARE&quot;</span>) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">vjust=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">11</span>, <span class="dt">hjust=</span><span class="dv">1</span>))+
<span class="st"> </span><span class="kw">coord_equal</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="looking-numerically-at-the-errors-in-dkp-vs-sk-chart" class="section level2">
<h2>Looking numerically at the errors in <code>DKP</code> vs <code>SK</code> chart</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get all `lp` Tpr curves</span>
tpr &lt;-<span class="st"> </span><span class="kw">getCurvesDigitized</span>(<span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 

<span class="co"># calculate HY for the given Tpr</span>
all_dak &lt;-<span class="st"> </span><span class="kw">z.Ann10</span>(<span class="dt">pres.pr =</span> ppr, <span class="dt">temp.pr =</span> tpr)
<span class="kw">cat</span>(<span class="st">&quot;Calculated from the correlation </span><span class="ch">\n</span><span class="st">&quot;</span>)
<span class="kw">print</span>(all_dak) 

<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Standing-Katz chart</span><span class="ch">\n</span><span class="st">&quot;</span>)
all_sk &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr, <span class="dt">tpr_vector =</span> tpr)
all_sk

<span class="co"># find the error</span>
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Errors in percentage </span><span class="ch">\n</span><span class="st">&quot;</span>)
all_err &lt;-<span class="st"> </span><span class="kw">round</span>((all_sk -<span class="st"> </span>all_dak) /<span class="st"> </span>all_sk *<span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)  <span class="co"># in percentage</span>
all_err

<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Errors in Ppr</span><span class="ch">\n</span><span class="st">&quot;</span>)
<span class="kw">summary</span>(all_err)

<span class="co"># for the transposed matrix</span>
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Errors for the transposed matrix: Tpr </span><span class="ch">\n</span><span class="st">&quot;</span>)
<span class="kw">summary</span>(<span class="kw">t</span>(all_err))</code></pre></div>
<pre><code>Calculated from the correlation 
           0.5       1.5       2.5       3.5       4.5       5.5       6.5
1.05 0.8324799 0.2526076 0.3420322 0.4693520 0.5991874 0.7254470 0.8464481
1.1  0.8547310 0.4309125 0.3930420 0.4983162 0.6136523 0.7278621 0.8417240
1.2  0.8953923 0.6607512 0.5179963 0.5676801 0.6492856 0.7424365 0.8393892
1.3  0.9196115 0.7567070 0.6394479 0.6341957 0.6857549 0.7611212 0.8471371
1.4  0.9367118 0.8179531 0.7301083 0.7058966 0.7360320 0.7938440 0.8650626
1.5  0.9508509 0.8607096 0.7940885 0.7685691 0.7867923 0.8323518 0.8918874
1.6  0.9607316 0.8909372 0.8413772 0.8186001 0.8303206 0.8669610 0.9174184
1.7  0.9682749 0.9146453 0.8767457 0.8581919 0.8672123 0.8978116 0.9413442
1.8  0.9758251 0.9330673 0.9033038 0.8900081 0.8983954 0.9253309 0.9638663
1.9  0.9814269 0.9463194 0.9244863 0.9154178 0.9242331 0.9491918 0.9841183
2    0.9839990 0.9572277 0.9414698 0.9352303 0.9453140 0.9693022 1.0014522
2.2  0.9900357 0.9744007 0.9641093 0.9632802 0.9770073 1.0002489 1.0281919
2.4  0.9948006 0.9851441 0.9796739 0.9835802 0.9995876 1.0223775 1.0476552
2.6  0.9973689 0.9948164 0.9945873 1.0008562 1.0160982 1.0374500 1.0612594
2.8  1.0003231 1.0036769 1.0082887 1.0163706 1.0293895 1.0474565 1.0693476
3    1.0028553 1.0095269 1.0179196 1.0286167 1.0412701 1.0563968 1.0751669

Standing-Katz chart
       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.05 0.829 0.253 0.343 0.471 0.598 0.727 0.846
1.10 0.854 0.426 0.393 0.500 0.615 0.729 0.841
1.20 0.893 0.657 0.519 0.565 0.650 0.741 0.841
1.30 0.916 0.756 0.638 0.633 0.684 0.759 0.844
1.40 0.936 0.816 0.727 0.705 0.734 0.792 0.865
1.50 0.948 0.859 0.794 0.770 0.790 0.836 0.892
1.60 0.959 0.888 0.839 0.816 0.829 0.868 0.918
1.70 0.968 0.914 0.876 0.857 0.864 0.897 0.942
1.80 0.974 0.933 0.905 0.891 0.901 0.929 0.967
1.90 0.978 0.945 0.924 0.916 0.924 0.949 0.985
2.00 0.982 0.956 0.941 0.937 0.945 0.969 1.003
2.20 0.989 0.973 0.963 0.963 0.976 1.000 1.029
2.40 0.993 0.984 0.980 0.983 0.999 1.023 1.049
2.60 0.997 0.994 0.994 1.000 1.016 1.038 1.062
2.80 0.999 1.002 1.008 1.016 1.030 1.049 1.069
3.00 1.002 1.009 1.018 1.029 1.041 1.056 1.075

 Errors in percentage 
       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.05 -0.42  0.16  0.28  0.35 -0.20  0.21 -0.05
1.10 -0.09 -1.15 -0.01  0.34  0.22  0.16 -0.09
1.20 -0.27 -0.57  0.19 -0.47  0.11 -0.19  0.19
1.30 -0.39 -0.09 -0.23 -0.19 -0.26 -0.28 -0.37
1.40 -0.08 -0.24 -0.43 -0.13 -0.28 -0.23 -0.01
1.50 -0.30 -0.20 -0.01  0.19  0.41  0.44  0.01
1.60 -0.18 -0.33 -0.28 -0.32 -0.16  0.12  0.06
1.70 -0.03 -0.07 -0.09 -0.14 -0.37 -0.09  0.07
1.80 -0.19 -0.01  0.19  0.11  0.29  0.39  0.32
1.90 -0.35 -0.14 -0.05  0.06 -0.03 -0.02  0.09
2.00 -0.20 -0.13 -0.05  0.19 -0.03 -0.03  0.15
2.20 -0.10 -0.14 -0.12 -0.03 -0.10 -0.02  0.08
2.40 -0.18 -0.12  0.03 -0.06 -0.06  0.06  0.13
2.60 -0.04 -0.08 -0.06 -0.09 -0.01  0.05  0.07
2.80 -0.13 -0.17 -0.03 -0.04  0.06  0.15 -0.03
3.00 -0.09 -0.05  0.01  0.04 -0.03 -0.04 -0.02

 Errors in Ppr
      0.5               1.5               2.5                3.5          
 Min.   :-0.4200   Min.   :-1.1500   Min.   :-0.43000   Min.   :-0.47000  
 1st Qu.:-0.2775   1st Qu.:-0.2100   1st Qu.:-0.09750   1st Qu.:-0.13250  
 Median :-0.1800   Median :-0.1350   Median :-0.04000   Median :-0.03500  
 Mean   :-0.1900   Mean   :-0.2081   Mean   :-0.04125   Mean   :-0.01188  
 3rd Qu.:-0.0900   3rd Qu.:-0.0775   3rd Qu.: 0.01500   3rd Qu.: 0.13000  
 Max.   :-0.0300   Max.   : 0.1600   Max.   : 0.28000   Max.   : 0.35000  
      4.5               5.5               6.5         
 Min.   :-0.3700   Min.   :-0.2800   Min.   :-0.3700  
 1st Qu.:-0.1700   1st Qu.:-0.0525   1st Qu.:-0.0225  
 Median :-0.0300   Median : 0.0150   Median : 0.0650  
 Mean   :-0.0275   Mean   : 0.0425   Mean   : 0.0375  
 3rd Qu.: 0.0725   3rd Qu.: 0.1525   3rd Qu.: 0.1000  
 Max.   : 0.4100   Max.   : 0.4400   Max.   : 0.3200  

 Errors for the transposed matrix: Tpr 
      1.05               1.10               1.20              1.30        
 Min.   :-0.42000   Min.   :-1.15000   Min.   :-0.5700   Min.   :-0.3900  
 1st Qu.:-0.12500   1st Qu.:-0.09000   1st Qu.:-0.3700   1st Qu.:-0.3250  
 Median : 0.16000   Median :-0.01000   Median :-0.1900   Median :-0.2600  
 Mean   : 0.04714   Mean   :-0.08857   Mean   :-0.1443   Mean   :-0.2586  
 3rd Qu.: 0.24500   3rd Qu.: 0.19000   3rd Qu.: 0.1500   3rd Qu.:-0.2100  
 Max.   : 0.35000   Max.   : 0.34000   Max.   : 0.1900   Max.   :-0.0900  
      1.40             1.50               1.60              1.70        
 Min.   :-0.430   Min.   :-0.30000   Min.   :-0.3300   Min.   :-0.3700  
 1st Qu.:-0.260   1st Qu.:-0.10500   1st Qu.:-0.3000   1st Qu.:-0.1150  
 Median :-0.230   Median : 0.01000   Median :-0.1800   Median :-0.0900  
 Mean   :-0.200   Mean   : 0.07714   Mean   :-0.1557   Mean   :-0.1029  
 3rd Qu.:-0.105   3rd Qu.: 0.30000   3rd Qu.:-0.0500   3rd Qu.:-0.0500  
 Max.   :-0.010   Max.   : 0.44000   Max.   : 0.1200   Max.   : 0.0700  
      1.80              1.90               2.00         
 Min.   :-0.1900   Min.   :-0.35000   Min.   :-0.20000  
 1st Qu.: 0.0500   1st Qu.:-0.09500   1st Qu.:-0.09000  
 Median : 0.1900   Median :-0.03000   Median :-0.03000  
 Mean   : 0.1571   Mean   :-0.06286   Mean   :-0.01429  
 3rd Qu.: 0.3050   3rd Qu.: 0.02000   3rd Qu.: 0.06000  
 Max.   : 0.3900   Max.   : 0.09000   Max.   : 0.19000  
      2.20               2.40               2.60         
 Min.   :-0.14000   Min.   :-0.18000   Min.   :-0.09000  
 1st Qu.:-0.11000   1st Qu.:-0.09000   1st Qu.:-0.07000  
 Median :-0.10000   Median :-0.06000   Median :-0.04000  
 Mean   :-0.06143   Mean   :-0.02857   Mean   :-0.02286  
 3rd Qu.:-0.02500   3rd Qu.: 0.04500   3rd Qu.: 0.02000  
 Max.   : 0.08000   Max.   : 0.13000   Max.   : 0.07000  
      2.80               3.00         
 Min.   :-0.17000   Min.   :-0.09000  
 1st Qu.:-0.08500   1st Qu.:-0.04500  
 Median :-0.03000   Median :-0.03000  
 Mean   :-0.02714   Mean   :-0.02571  
 3rd Qu.: 0.01500   3rd Qu.:-0.00500  
 Max.   : 0.15000   Max.   : 0.04000  </code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
